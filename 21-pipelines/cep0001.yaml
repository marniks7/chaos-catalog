apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: cep0001
  namespace: tekton-namespace
spec:
  params:
    - name: namespace
      type: string
      description: Target namespace where to apply
    - name: test
      type: string
  tasks:
    - name: k-get-pods
      taskRef:
        name: kubernetes-actions
      params:
        - name: script
          value: |
            kubectl get pods -n $(params.namespace)
            echo "$(params.test)"
      workspaces:
        - name: kubeconfig-dir
          workspace: kubeconfig-dir
    - name: test
      taskRef:
        name: kubernetes-actions
      params:
        - name: script
          value: |
            kubectl get pods -n $(params.namespace)
            echo "test1"
      runAfter:
        - k-get-pods
      workspaces:
        - name: kubeconfig-dir
          workspace: kubeconfig-dir
    - name: test2
      taskRef:
        name: kubernetes-actions
      params:
        - name: script
          value: |
            kubectl get pods -n $(params.namespace)
            echo "test2"
      runAfter:
        - k-get-pods
      workspaces:
        - name: kubeconfig-dir
          workspace: kubeconfig-dir
  workspaces:
    - name: kubeconfig-dir

